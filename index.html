<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORA Terminal Shell</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #0a0a0a;
            color: #f0f0f0;
            font-family: 'Courier New', 'Cascadia Code', monospace;
            height: 100vh;
            overflow: hidden;
            position: relative;
            user-select: none;
        }
        
        /* Matrix Canvas Background */
        #matrix-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0.08;
        }
        
        /* Control Panel */
        .control-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(20, 20, 20, 0.9);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #333;
            backdrop-filter: blur(10px);
            max-width: 300px;
        }
        
        .control-title {
            color: #4af626;
            margin-bottom: 10px;
            font-size: 14px;
            text-align: center;
        }
        
        .panel-btn {
            background: #333;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
            width: 100%;
            margin-top: 5px;
            transition: all 0.3s;
        }
        
        .panel-btn:hover {
            background: #444;
        }
        
        .file-preview {
            margin-top: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
            font-size: 11px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        /* Terminal Container - Draggable & Resizable */
        .terminal-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 800px;
            height: 500px;
            background-color: rgba(0, 0, 0, 0.95);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
            border: 1px solid #333;
            z-index: 10;
            min-width: 400px;
            min-height: 300px;
            resize: both;
            overflow: hidden;
        }
        
        /* Terminal Header - Draggable area */
        .terminal-header {
            background: linear-gradient(to bottom, #1a1a1a, #000);
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #333;
            cursor: move;
            user-select: none;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .terminal-buttons {
            display: flex;
            gap: 10px;
        }
        
        .terminal-button {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .terminal-button:hover {
            transform: scale(1.1);
        }
        
        .close { background-color: #ff5f56; }
        .minimize { background-color: #ffbd2e; }
        .maximize { background-color: #27ca3f; }
        
        .terminal-title {
            color: #888;
            font-size: 14px;
            flex-grow: 1;
            text-align: center;
            margin: 0 20px;
        }
        
        /* Terminal Body */
        .terminal-body {
            height: calc(100% - 45px);
            padding: 20px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.9);
        }
        
        .output {
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-bottom: 8px;
            line-height: 1.4;
            font-size: 14px;
        }
        
        .prompt {
            color: #4af626;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .input-line {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }
        
        .command-input {
            background: transparent;
            border: none;
            color: #f0f0f0;
            font-family: inherit;
            font-size: 14px;
            width: 100%;
            outline: none;
            caret-color: #4af626;
            flex: 1;
        }
        
        /* Text Colors */
        .command { color: #4af626; }
        .error { color: #ff5555; }
        .success { color: #50fa7b; }
        .info { color: #8be9fd; }
        .system { color: #bd93f9; }
        .warning { color: #ffb86c; }
        .matrix { color: #00ff9d; }
        .hacker { color: #00ff00; }
        .file { color: #ffaa00; }
        .link { color: #00aaff; }
        
        /* Cursor */
        .cursor {
            display: inline-block;
            width: 8px;
            height: 16px;
            background-color: #4af626;
            margin-left: 2px;
            animation: blink 1s infinite;
            vertical-align: middle;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* Scrollbar */
        .terminal-body::-webkit-scrollbar {
            width: 10px;
        }
        
        .terminal-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .terminal-body::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 5px;
        }
        
        .terminal-body::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* Resize Handle */
        .resize-handle {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 20px;
            height: 20px;
            cursor: nwse-resize;
            z-index: 20;
        }
        
        .resize-handle::after {
            content: '';
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 10px;
            height: 10px;
            border-right: 2px solid #444;
            border-bottom: 2px solid #444;
        }
        
        /* Link Display Box */
        .link-box {
            background: rgba(0, 170, 255, 0.1);
            border: 1px solid #00aaff;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            word-break: break-all;
            position: relative;
        }
        
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #00aaff;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
        }
        
        .copy-btn:hover {
            background: #0088cc;
        }
        
        .copy-success {
            position: absolute;
            top: 10px;
            right: 80px;
            color: #50fa7b;
            font-size: 12px;
            animation: fadeOut 2s forwards;
        }
        
        @keyframes fadeOut {
            0% { opacity: 1; }
            70% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        /* File List */
        .file-item {
            padding: 5px 0;
            border-bottom: 1px solid rgba(0, 255, 0, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .file-item:hover {
            background: rgba(0, 255, 0, 0.05);
        }
        
        .file-icon {
            width: 20px;
            text-align: center;
        }
        
        .file-size {
            margin-left: auto;
            color: #888;
            font-size: 12px;
        }
        
        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #444;
            border-top-color: #00ff00;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            vertical-align: middle;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .terminal-container {
                width: 95vw !important;
                height: 80vh !important;
                position: fixed !important;
                top: 10vh !important;
                left: 2.5vw !important;
                transform: none !important;
                min-width: 300px !important;
                min-height: 400px !important;
                resize: none;
            }
            
            .control-panel {
                top: 10px;
                right: 10px;
                padding: 10px;
                max-width: 200px;
            }
            
            .terminal-header {
                padding: 10px 15px;
            }
            
            .terminal-body {
                padding: 15px;
            }
        }
        
        /* Terminal Startup Animation */
        @keyframes terminalStart {
            0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        .terminal-start-animation {
            animation: terminalStart 0.5s ease-out;
        }
    </style>
</head>
<body>
    <!-- Matrix Canvas Background -->
    <canvas id="matrix-canvas"></canvas>
    
    <!-- Control Panel -->
    <div class="control-panel">
        <div class="control-title">ORA TERMINAL CONTROL</div>
        <div id="file-preview" class="file-preview">
            <span class="system">GitHub Files System</span><br>
            <span class="info">Connected to: github.com/MKB-NEL</span>
        </div>
        <button class="panel-btn" id="hide-panel">Hide Panel</button>
        <button class="panel-btn" id="reset-terminal">Reset Terminal</button>
        <button class="panel-btn" id="show-link">Show Secure Link</button>
    </div>
    
    <!-- Terminal Window -->
    <div class="terminal-container terminal-start-animation">
        <div class="terminal-header" id="terminal-header">
            <div class="header-left">
                <div class="terminal-buttons">
                    <div class="terminal-button close" id="close-btn"></div>
                    <div class="terminal-button minimize" id="minimize-btn"></div>
                    <div class="terminal-button maximize" id="maximize-btn"></div>
                </div>
                <div class="terminal-title">ora terminal shell</div>
            </div>
        </div>
        
        <div class="terminal-body" id="terminal-output">
            <div class="output">
                <span class="system">system 0.1 is running</span><br>
                <span class="system">> ora terminal shell</span><br>
                <span class="system">> made by Bertrand</span><br>
                <span class="system">> 2025</span><br><br>
                <span class="info">Type 'help' to see functions</span><br>
                <span class="info">Type 'orastart' to launch ORA Tool</span><br>
                <span class="info">Type 'link show' to access secure link</span><br>
                <span class="info">Type 'color 1-12' to change matrix color</span><br><br>
            </div>
        </div>
        
        <div class="resize-handle"></div>
    </div>

    <script>
        // ==============================
        // MATRIX ANIMATION
        // ==============================
        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');
        let matrixColor = '#00ff9d';
        
        // Color definitions for 12 colors
        const matrixColors = [
            '#00ff9d', // 1 - Matrix Green
            '#4af626', // 2 - Neon Green
            '#00ffff', // 3 - Cyan
            '#ff00ff', // 4 - Magenta
            '#ffaa00', // 5 - Orange
            '#ff5555', // 6 - Red
            '#ffffff', // 7 - White
            '#9d00ff', // 8 - Purple
            '#00aaff', // 9 - Blue
            '#ffff00', // 10 - Yellow
            '#ff6b8b', // 11 - Pink
            '#00ff00'  // 12 - Pure Green
        ];
        
        // Set canvas size
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        
        // Matrix characters
        const chars = "01„Ç¢„Ç°„Ç´„Çµ„Çø„Éä„Éè„Éû„É§„É£„É©„ÉØ„Ç¨„Ç∂„ÉÄ„Éê„Éë„Ç§„Ç£„Ç≠„Ç∑„ÉÅ„Éã„Éí„Éü„É™„É∞„ÇÆ„Ç∏„ÉÇ„Éì„Éî„Ç¶„Ç•„ÇØ„Çπ„ÉÑ„Éå„Éï„É†„É¶„É•„É´„Ç∞„Ç∫„Éñ„ÉÖ„Éó„Ç®„Çß„Ç±„Çª„ÉÜ„Éç„Éò„É°„É¨„É±„Ç≤„Çº„Éá„Éô„Éö„Ç™„Ç©„Ç≥„ÇΩ„Éà„Éé„Éõ„É¢„É®„Éß„É≠„É≤„Ç¥„Çæ„Éâ„Éú„Éù„É¥„ÉÉ„É≥";
        const charArray = chars.split("");
        const fontSize = 14;
        let columns = 0;
        let drops = [];
        
        // Initialize matrix
        function initMatrix() {
            resizeCanvas();
            columns = Math.floor(canvas.width / fontSize);
            drops = [];
            for(let i = 0; i < columns; i++) {
                drops[i] = Math.floor(Math.random() * canvas.height / fontSize);
            }
        }
        
        // Draw matrix
        function drawMatrix() {
            // Semi-transparent black rectangle for trail effect
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Set text style
            ctx.font = `${fontSize}px 'Courier New', monospace`;
            
            // Draw characters
            for(let i = 0; i < drops.length; i++) {
                // Random character
                const char = charArray[Math.floor(Math.random() * charArray.length)];
                
                // Gradient color effect
                const opacity = Math.random() * 0.5 + 0.5;
                ctx.fillStyle = matrixColor.replace(')', `, ${opacity})`).replace('rgb', 'rgba');
                
                // Draw character
                ctx.fillText(char, i * fontSize, drops[i] * fontSize);
                
                // Move drop down
                drops[i]++;
                
                // Randomly reset drop
                if(drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
            }
        }
        
        // ==============================
        // LINK SYSTEM
        // ==============================
        class LinkSystem {
            constructor() {
                this.driveLink = "https://drive.google.com/drive/folders/11EI-l9iNJ9y0FXA-Fb97Yg4DDavRMeRQ";
                this.githubFilesLink = "https://github.com/MKB-NEL/orabymkb/tree/main/files";
                this.password = "karekezi@2";
                this.isLinkVisible = false;
            }
            
            showLinkPrompt() {
                const output = document.getElementById('terminal-output');
                output.innerHTML = '';
                
                const promptDiv = document.createElement('div');
                promptDiv.className = 'output';
                promptDiv.innerHTML = '<span class="hacker">Secure Link Password:</span>';
                output.appendChild(promptDiv);
                
                this.createPasswordInput();
            }
            
            createPasswordInput() {
                const output = document.getElementById('terminal-output');
                const inputLine = document.createElement('div');
                inputLine.className = 'input-line';
                
                inputLine.innerHTML = `
                    <span class="prompt">Password:</span>
                    <input type="password" 
                           class="command-input link-password"
                           autocomplete="off" 
                           autofocus
                           style="color: transparent; text-shadow: 0 0 0 #00ff00;">
                    <span class="cursor"></span>
                `;
                
                output.appendChild(inputLine);
                
                const input = inputLine.querySelector('.command-input');
                input.focus();
                
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        const value = input.value.trim();
                        inputLine.remove();
                        this.verifyPassword(value);
                    }
                });
                
                output.scrollTop = output.scrollHeight;
            }
            
            verifyPassword(password) {
                const output = document.getElementById('terminal-output');
                
                if (password === this.password) {
                    this.isLinkVisible = true;
                    this.displaySecureLink();
                } else {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'output error';
                    errorDiv.textContent = 'Incorrect password. Access denied.';
                    output.appendChild(errorDiv);
                    
                    setTimeout(() => {
                        createInputLine();
                    }, 1000);
                }
                
                output.scrollTop = output.scrollHeight;
            }
            
            displaySecureLink() {
                const output = document.getElementById('terminal-output');
                output.innerHTML = '';
                
                const successDiv = document.createElement('div');
                successDiv.className = 'output success';
                successDiv.innerHTML = '<span class="success">‚úì Access granted. Secure link unlocked.</span>';
                output.appendChild(successDiv);
                
                const linkBox = document.createElement('div');
                linkBox.className = 'link-box';
                linkBox.innerHTML = `
                    <span class="link">${this.driveLink}</span>
                    <button class="copy-btn" onclick="copyToClipboard('${this.driveLink}')">Copy</button>
                `;
                output.appendChild(linkBox);
                
                const infoDiv = document.createElement('div');
                infoDiv.className = 'output';
                infoDiv.innerHTML = `
                    <span class="info">This link provides access to secured files.</span><br>
                    <span class="info">GitHub Files: ${this.githubFilesLink}</span><br><br>
                    <span class="warning">‚ö†Ô∏è This link is sensitive. Handle with care.</span>
                `;
                output.appendChild(infoDiv);
                
                createInputLine();
            }
        }
        
        // ==============================
        // GITHUB FILE SYSTEM
        // ==============================
        class GitHubFileSystem {
            constructor() {
                this.githubBaseUrl = "https://github.com/MKB-NEL/orabymkb/tree/main/files/";
                this.rawBaseUrl = "https://raw.githubusercontent.com/MKB-NEL/orabymkb/main/files/";
                this.files = [];
                this.fileTypes = {
                    '.pdf': 'üìï', '.doc': 'üìò', '.docx': 'üìò',
                    '.jpg': 'üñºÔ∏è', '.jpeg': 'üñºÔ∏è', '.png': 'üñºÔ∏è', '.gif': 'üñºÔ∏è',
                    '.txt': 'üìù', '.md': 'üìù', '.rtf': 'üìù',
                    '.xls': 'üìä', '.xlsx': 'üìä', '.csv': 'üìä',
                    '.zip': 'üì¶', '.rar': 'üì¶', '.7z': 'üì¶',
                    '.mp3': 'üéµ', '.wav': 'üéµ', '.mp4': 'üé¨', '.avi': 'üé¨',
                    '.html': 'üåê', '.css': 'üé®', '.js': 'üìú', '.json': 'üìÑ'
                };
            }
            
            getFileIcon(filename) {
                const extension = filename.substring(filename.lastIndexOf('.')).toLowerCase();
                return this.fileTypes[extension] || 'üìÑ';
            }
            
            async scanGitHubFiles() {
                try {
                    // Since we can't directly fetch from GitHub due to CORS,
                    // we'll simulate the file structure based on common patterns
                    console.log('Scanning GitHub repository structure...');
                    
                    // Simulated file list based on typical GitHub structure
                    this.files = [
                        { name: 'S6 ALL-ENGLISH.pdf', path: this.githubBaseUrl + 'S6 ALL-ENGLISH.pdf', rawPath: this.rawBaseUrl + 'S6 ALL-ENGLISH.pdf', isDirectory: false, icon: 'üìï', size: '~2.4 MB', type: 'PDF Document' },
                        { name: 'Academic Papers/', path: this.githubBaseUrl + 'Academic%20Papers/', isDirectory: true, icon: 'üìÅ', size: '--', type: 'Directory' },
                        { name: 'Research Documents/', path: this.githubBaseUrl + 'Research%20Documents/', isDirectory: true, icon: 'üìÅ', size: '--', type: 'Directory' },
                        { name: 'Project Files/', path: this.githubBaseUrl + 'Project%20Files/', isDirectory: true, icon: 'üìÅ', size: '--', type: 'Directory' },
                        { name: 'Configuration/', path: this.githubBaseUrl + 'Configuration/', isDirectory: true, icon: 'üìÅ', size: '--', type: 'Directory' },
                        { name: 'Backups/', path: this.githubBaseUrl + 'Backups/', isDirectory: true, icon: 'üìÅ', size: '--', type: 'Directory' },
                        { name: 'README.txt', path: this.githubBaseUrl + 'README.txt', rawPath: this.rawBaseUrl + 'README.txt', isDirectory: false, icon: 'üìù', size: '~1.2 KB', type: 'Text Document' },
                        { name: 'config.json', path: this.githubBaseUrl + 'config.json', rawPath: this.rawBaseUrl + 'config.json', isDirectory: false, icon: 'üìÑ', size: '~0.8 KB', type: 'JSON Config' }
                    ];
                    
                    this.updateFilePreview();
                    return this.files;
                    
                } catch (error) {
                    console.log('Using simulated GitHub file structure:', error.message);
                    this.files = this.getDefaultFiles();
                    this.updateFilePreview();
                    return this.files;
                }
            }
            
            getDefaultFiles() {
                return [
                    { name: 'S6 ALL-ENGLISH.pdf', path: this.githubBaseUrl + 'S6 ALL-ENGLISH.pdf', rawPath: this.rawBaseUrl + 'S6 ALL-ENGLISH.pdf', isDirectory: false, icon: 'üìï', size: '~2.4 MB', type: 'PDF Document' },
                    { name: 'Academic Papers/', path: this.githubBaseUrl + 'Academic%20Papers/', isDirectory: true, icon: 'üìÅ', size: '--', type: 'Directory' },
                    { name: 'Research Documents/', path: this.githubBaseUrl + 'Research%20Documents/', isDirectory: true, icon: 'üìÅ', size: '--', type: 'Directory' },
                    { name: 'Project Files/', path: this.githubBaseUrl + 'Project%20Files/', isDirectory: true, icon: 'üìÅ', size: '--', type: 'Directory' }
                ];
            }
            
            updateFilePreview() {
                const preview = document.getElementById('file-preview');
                if (!preview) return;
                
                preview.innerHTML = `<span class="system">GitHub Files: ${this.files.length}</span><br>
                <span class="info">Repository: MKB-NEL/orabymkb</span><br>`;
                
                this.files.slice(0, 4).forEach(file => {
                    preview.innerHTML += `<span class="file">${file.icon} ${file.name}</span><br>`;
                });
                
                if (this.files.length > 4) {
                    preview.innerHTML += `<span class="info">...and ${this.files.length - 4} more</span>`;
                }
            }
            
            async getFileContent(filename) {
                try {
                    const file = this.files.find(f => f.name === filename);
                    if (!file || file.isDirectory) {
                        throw new Error('File not found or is directory');
                    }
                    
                    // For simulation, return sample content
                    if (filename.endsWith('.pdf')) {
                        return `PDF File: ${filename}\n\nThis is a simulated preview of the PDF document.\nActual file is stored in GitHub repository.\n\nTo download the actual file, use the "download" command.`;
                    } else if (filename.endsWith('.txt') || filename.endsWith('.md')) {
                        return `Text File: ${filename}\n\nThis file is part of the ORA Terminal project.\nStored in GitHub repository: ${this.githubBaseUrl}\n\nAccess the actual content via GitHub directly.`;
                    } else if (filename.endsWith('.json')) {
                        return `{\n  "file": "${filename}",\n  "repository": "MKB-NEL/orabymkb",\n  "path": "files/${filename}",\n  "type": "configuration",\n  "status": "stored_in_github"\n}`;
                    }
                    
                    return `File: ${filename}\nType: ${file.type}\nSize: ${file.size}\nLocation: ${file.path}\n\nThis file is stored in the GitHub repository.`;
                    
                } catch (error) {
                    console.log('Using simulated content for:', filename);
                    return `Content preview for ${filename}\n\nThis file is stored in GitHub repository:\n${this.githubBaseUrl}\n\nTo access the actual file, visit the GitHub link above.`;
                }
            }
            
            async downloadFile(filename) {
                try {
                    const file = this.files.find(f => f.name === filename);
                    if (!file) {
                        throw new Error('File not found');
                    }
                    
                    if (file.isDirectory) {
                        throw new Error('Cannot download directory');
                    }
                    
                    // Create a simulated download with file info
                    const content = await this.getFileContent(filename);
                    const blob = new Blob([content], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    window.URL.revokeObjectURL(url);
                    
                    return true;
                } catch (error) {
                    console.error('Error simulating download:', error);
                    return false;
                }
            }
            
            openInGitHub(filename) {
                const file = this.files.find(f => f.name === filename);
                if (file && !file.isDirectory) {
                    window.open(file.path, '_blank');
                    return true;
                }
                return false;
            }
        }
        
        // ==============================
        // ORA TOOL SYSTEM
        // ==============================
        class ORATool {
            constructor() {
                this.mode = 'normal';
                this.currentPath = '/';
                this.currentFile = null;
                this.loggedIn = false;
                this.username = 'bertrand';
                this.password = 'karekezi@2';
                this.fileSystem = new GitHubFileSystem();
                this.linkSystem = new LinkSystem();
                this.isBooting = false;
            }
            
            // ==============================
            // BOOT SEQUENCE
            // ==============================
            async startBootSequence() {
                if (this.isBooting) return;
                
                this.isBooting = true;
                this.mode = 'boot';
                const output = document.getElementById('terminal-output');
                output.innerHTML = '';
                
                const bootMessages = [
                    "[BOOT] Starting ORA Secure Boot Sequence...",
                    "[OK] Memory test passed",
                    "[OK] CPU: 8 cores detected",
                    "[OK] RAM: 16GB available",
                    "[LOAD] Loading kernel modules...",
                    "   -> module_security.ko [LOADED]",
                    "   -> module_encryption.ko [LOADED]",
                    "   -> module_network.ko [LOADED]",
                    "   -> module_github_fs.ko [LOADED]",
                    "[OK] All modules loaded",
                    "[CRYPTO] Initializing encryption...",
                    "   Generating RSA-4096 keys...",
                    "   Setting up AES-256...",
                    "[OK] Encryption ready",
                    "[NET] Configuring network...",
                    "   Establishing secure connection...",
                    "   Connecting to GitHub API...",
                    "[OK] Network: ONLINE",
                    "[AUTH] Starting authentication service...",
                    "[SCAN] Running system integrity check...",
                    "   Checking file permissions...",
                    "   Verifying signatures...",
                    "   Scanning for vulnerabilities...",
                    "[OK] System integrity: 100%",
                    "[SECURE] Entering secure mode...",
                    "[GITHUB] Connecting to repository...",
                    "   Repository: MKB-NEL/orabymkb",
                    "   Branch: main",
                    "   Path: /files",
                    "[OK] GitHub connection established",
                    "[INIT] Starting ORA Tool Environment...",
                    "   Loading user profiles...",
                    "   Mounting GitHub filesystem...",
                    "   Initializing UI components...",
                    "[OK] Environment initialized",
                    "[WAIT] Finalizing boot process..."
                ];
                
                for (let i = 0; i < bootMessages.length; i++) {
                    await new Promise(resolve => setTimeout(resolve, 80));
                    const line = document.createElement('div');
                    line.className = 'output hacker';
                    line.textContent = bootMessages[i];
                    
                    if (Math.random() > 0.7) {
                        line.style.opacity = '0.5';
                        setTimeout(() => line.style.opacity = '1', 50);
                    }
                    
                    output.appendChild(line);
                    output.scrollTop = output.scrollHeight;
                }
                
                await new Promise(resolve => setTimeout(resolve, 500));
                const finalMsg = document.createElement('div');
                finalMsg.className = 'output success';
                finalMsg.textContent = "[OK] Initialization complete. Connected to GitHub.";
                output.appendChild(finalMsg);
                
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                this.mode = 'login';
                this.isBooting = false;
                this.showLoginPrompt();
            }
            
            // ==============================
            // LOGIN SYSTEM
            // ==============================
            showLoginPrompt() {
                const output = document.getElementById('terminal-output');
                output.innerHTML = '';
                
                const loginDiv = document.createElement('div');
                loginDiv.className = 'output';
                loginDiv.innerHTML = '<span class="hacker">Username:</span>';
                output.appendChild(loginDiv);
                
                this.createLoginInput('username');
            }
            
            createLoginInput(field) {
                const output = document.getElementById('terminal-output');
                const inputLine = document.createElement('div');
                inputLine.className = 'input-line';
                
                const prompt = field === 'username' ? 'Username:' : 'Password:';
                
                inputLine.innerHTML = `
                    <span class="prompt">${prompt}</span>
                    <input type="${field === 'password' ? 'password' : 'text'}" 
                           class="command-input login-field"
                           autocomplete="off" 
                           autofocus
                           ${field === 'password' ? 'style="color: transparent; text-shadow: 0 0 0 #00ff00;"' : ''}>
                    <span class="cursor"></span>
                `;
                
                output.appendChild(inputLine);
                
                const input = inputLine.querySelector('.command-input');
                input.focus();
                
                input.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        const value = input.value.trim();
                        inputLine.remove();
                        this.processLoginInput(field, value);
                    }
                });
                
                output.scrollTop = output.scrollHeight;
            }
            
            processLoginInput(field, value) {
                const output = document.getElementById('terminal-output');
                
                if (field === 'username') {
                    if (value.toLowerCase() === this.username) {
                        const resultDiv = document.createElement('div');
                        resultDiv.className = 'output';
                        resultDiv.innerHTML = `<span class="success">Username verified</span>`;
                        output.appendChild(resultDiv);
                        
                        setTimeout(() => {
                            const promptDiv = document.createElement('div');
                            promptDiv.className = 'output';
                            promptDiv.innerHTML = `<span class="hacker">Password:</span>`;
                            output.appendChild(promptDiv);
                            this.createLoginInput('password');
                        }, 500);
                    } else {
                        const resultDiv = document.createElement('div');
                        resultDiv.className = 'output';
                        resultDiv.innerHTML = `<span class="error">Invalid username. Try again.</span>`;
                        output.appendChild(resultDiv);
                        
                        setTimeout(() => {
                            const promptDiv = document.createElement('div');
                            promptDiv.className = 'output';
                            promptDiv.innerHTML = `<span class="hacker">Username:</span>`;
                            output.appendChild(promptDiv);
                            this.createLoginInput('username');
                        }, 1000);
                    }
                } else if (field === 'password') {
                    if (value === this.password) {
                        this.loggedIn = true;
                        
                        const resultDiv = document.createElement('div');
                        resultDiv.className = 'output';
                        resultDiv.innerHTML = `
                            <span class="success">Login successful.</span><br>
                            <span class="hacker">Welcome to ORA Tool Environment.</span>
                        `;
                        output.appendChild(resultDiv);
                        
                        setTimeout(() => {
                            this.enterORATool();
                        }, 1500);
                    } else {
                        const resultDiv = document.createElement('div');
                        resultDiv.className = 'output';
                        resultDiv.innerHTML = `<span class="error">Incorrect password.</span>`;
                        output.appendChild(resultDiv);
                        
                        setTimeout(() => {
                            const promptDiv = document.createElement('div');
                            promptDiv.className = 'output';
                            promptDiv.innerHTML = `<span class="hacker">Password:</span>`;
                            output.appendChild(promptDiv);
                            this.createLoginInput('password');
                        }, 1000);
                    }
                }
                
                output.scrollTop = output.scrollHeight;
            }
            
            // ==============================
            // ORA TOOL ENVIRONMENT
            // ==============================
            async enterORATool() {
                this.mode = 'ora-tool';
                this.currentPath = '/github/files';
                this.currentFile = null;
                
                const output = document.getElementById('terminal-output');
                output.innerHTML = '';
                
                const files = await this.fileSystem.scanGitHubFiles();
                
                const welcomeDiv = document.createElement('div');
                welcomeDiv.className = 'output';
                welcomeDiv.innerHTML = `
                    <span class="hacker">Entering ORA Tool...</span><br>
                    <span class="hacker">Connecting to GitHub Repository...</span><br>
                    <span class="success">Repository: MKB-NEL/orabymkb</span><br>
                    <span class="success">Path: /files</span><br>
                    <span class="success">Found ${files.length} files/directories</span><br><br>
                    <span class="info">Type "ls" to view GitHub files.</span><br>
                    <span class="info">Type "cd filename" to open a file.</span><br>
                    <span class="info">Type "github" to open repository in browser.</span><br>
                    <span class="info">Type "exit" to quit ORA Tool.</span>
                `;
                output.appendChild(welcomeDiv);
                
                createInputLine();
            }
            
            // ==============================
            // FILE LISTING
            // ==============================
            async listFiles() {
                const output = document.getElementById('terminal-output');
                output.innerHTML = '';
                
                const files = await this.fileSystem.scanGitHubFiles();
                
                const headerDiv = document.createElement('div');
                headerDiv.className = 'output';
                headerDiv.innerHTML = `<span class="info">GitHub Repository: ${this.currentPath}</span><br>`;
                output.appendChild(headerDiv);
                
                if (files.length === 0) {
                    const emptyDiv = document.createElement('div');
                    emptyDiv.className = 'output error';
                    emptyDiv.textContent = 'No files found in GitHub repository';
                    output.appendChild(emptyDiv);
                } else {
                    files.forEach(file => {
                        const fileDiv = document.createElement('div');
                        fileDiv.className = 'output file-item';
                        fileDiv.innerHTML = `
                            <span class="file-icon">${file.icon}</span>
                            <span class="${file.isDirectory ? 'info' : 'system'}">${file.name}</span>
                            <span class="file-size">${file.size}</span>
                        `;
                        output.appendChild(fileDiv);
                    });
                }
                
                const helpDiv = document.createElement('div');
                helpDiv.className = 'output';
                helpDiv.innerHTML = `<br><span class="system">Type "cd filename" to open, "github" for repository link, or "exit" to quit.</span>`;
                output.appendChild(helpDiv);
                
                createInputLine();
            }
            
            // ==============================
            // FILE MODE
            // ==============================
            async enterFileMode(fileName) {
                this.mode = 'file-mode';
                this.currentFile = fileName;
                
                const output = document.getElementById('terminal-output');
                output.innerHTML = '';
                
                const files = await this.fileSystem.scanGitHubFiles();
                const file = files.find(f => f.name === fileName);
                
                if (!file) {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'output error';
                    errorDiv.textContent = `File not found: ${fileName}`;
                    output.appendChild(errorDiv);
                    createInputLine();
                    return;
                }
                
                const headerDiv = document.createElement('div');
                headerDiv.className = 'file-mode-header';
                headerDiv.innerHTML = `
                    <span class="hacker">=== FILE MODE: ${fileName} ===</span><br>
                    <span class="system">GitHub Path: ${file.path}</span><br>
                    <span class="system">Size: ${file.size}</span><br>
                    <span class="system">Type: ${file.isDirectory ? 'DIRECTORY' : file.type}</span><br><br>
                    <span class="info">Available commands:</span><br>
                    <span class="command">open</span> - Open in GitHub<br>
                    <span class="command">print</span> - Print file<br>
                    <span class="command">download</span> - Download file<br>
                    <span class="command">view</span> - View file info<br>
                    <span class="command">exit</span> - Exit file mode<br>
                `;
                output.appendChild(headerDiv);
                
                if (!file.isDirectory) {
                    const content = await this.fileSystem.getFileContent(fileName);
                    
                    const contentDiv = document.createElement('div');
                    contentDiv.className = 'output';
                    contentDiv.style.background = 'rgba(0, 255, 0, 0.05)';
                    contentDiv.style.padding = '15px';
                    contentDiv.style.marginTop = '20px';
                    contentDiv.style.borderRadius = '5px';
                    contentDiv.innerHTML = `<pre style="margin:0;">${content}</pre>`;
                    output.appendChild(contentDiv);
                    
                    const infoDiv = document.createElement('div');
                    infoDiv.className = 'output';
                    infoDiv.innerHTML = `<span class="info">GitHub Link: <a href="${file.path}" target="_blank" style="color:#00aaff;">${file.path}</a></span>`;
                    output.appendChild(infoDiv);
                } else if (file.isDirectory) {
                    const dirDiv = document.createElement('div');
                    dirDiv.className = 'output warning';
                    dirDiv.innerHTML = `üìÅ This is a directory in GitHub.<br>Visit: <a href="${file.path}" target="_blank" style="color:#00aaff;">${file.path}</a>`;
                    output.appendChild(dirDiv);
                }
                
                createInputLine();
            }
            
            async executeFileCommand(command) {
                const output = document.getElementById('terminal-output');
                const resultDiv = document.createElement('div');
                resultDiv.className = 'output';
                
                switch(command) {
                    case 'open':
                        const opened = this.fileSystem.openInGitHub(this.currentFile);
                        if (opened) {
                            resultDiv.innerHTML = `<span class="success">Opening ${this.currentFile} in GitHub...</span>`;
                        } else {
                            resultDiv.innerHTML = `<span class="error">Cannot open directory in browser</span>`;
                        }
                        break;
                        
                    case 'print':
                        resultDiv.innerHTML = `<span class="system">Opening print dialog for ${this.currentFile}...</span>`;
                        setTimeout(() => {
                            window.print();
                        }, 500);
                        break;
                        
                    case 'download':
                        resultDiv.innerHTML = `<span class="loading"></span><span class="info">Downloading ${this.currentFile}...</span>`;
                        output.appendChild(resultDiv);
                        
                        const success = await this.fileSystem.downloadFile(this.currentFile);
                        if (success) {
                            resultDiv.innerHTML = `<span class="success">Download started: ${this.currentFile}</span>`;
                        } else {
                            resultDiv.innerHTML = `<span class="error">Failed to download ${this.currentFile}</span>`;
                        }
                        break;
                        
                    case 'view':
                        this.enterFileMode(this.currentFile);
                        return;
                        
                    case 'exit':
                        this.exitFileMode();
                        return;
                }
                
                if (command !== 'exit') {
                    createInputLine();
                }
            }
            
            exitFileMode() {
                this.mode = 'ora-tool';
                this.currentFile = null;
                
                const output = document.getElementById('terminal-output');
                output.innerHTML = '';
                
                const exitDiv = document.createElement('div');
                exitDiv.className = 'output';
                exitDiv.innerHTML = `<span class="system">Exiting file...</span>`;
                output.appendChild(exitDiv);
                
                setTimeout(() => {
                    this.listFiles();
                }, 500);
            }
            
            exitORATool() {
                this.mode = 'normal';
                this.currentPath = '/';
                this.currentFile = null;
                this.loggedIn = false;
                
                const output = document.getElementById('terminal-output');
                output.innerHTML = '';
                
                const exitDiv = document.createElement('div');
                exitDiv.className = 'output';
                exitDiv.innerHTML = `
                    <span class="system">Exiting ORA Tool...</span><br>
                    <span class="success">Returning to ORA Terminal.</span><br><br>
                `;
                output.appendChild(exitDiv);
                
                setTimeout(() => {
                    output.innerHTML = '';
                    const welcomeDiv = document.createElement('div');
                    welcomeDiv.className = 'output';
                    welcomeDiv.innerHTML = `
                        <span class="system">system 0.1 is running</span><br>
                        <span class="system">> ora terminal shell</span><br>
                        <span class="system">> made by Bertrand</span><br>
                        <span class="system">> 2025</span><br><br>
                        <span class="info">Type 'help' to see functions</span><br>
                        <span class="info">Type 'orastart' to launch ORA Tool</span><br>
                        <span class="info">Type 'link show' to access secure link</span><br>
                        <span class="info">Type 'color 1-12' to change matrix color</span><br><br>
                    `;
                    output.appendChild(welcomeDiv);
                    createInputLine();
                }, 1500);
            }
            
            async handleORAToolCommand(cmd, args) {
                const output = document.getElementById('terminal-output');
                
                if (cmd === 'ls') {
                    await this.listFiles();
                    return true;
                } else if (cmd === 'cd') {
                    if (args.length === 0) {
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'output error';
                        errorDiv.textContent = 'Usage: cd filename';
                        output.appendChild(errorDiv);
                        createInputLine();
                        return true;
                    }
                    
                    const fileName = args[0];
                    const files = await this.fileSystem.scanGitHubFiles();
                    const file = files.find(f => f.name === fileName);
                    
                    if (!file) {
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'output error';
                        errorDiv.textContent = `File not found: ${fileName}`;
                        output.appendChild(errorDiv);
                        createInputLine();
                        return true;
                    }
                    
                    const msgDiv = document.createElement('div');
                    msgDiv.className = 'output';
                    msgDiv.innerHTML = `<span class="system">Opening ${file.isDirectory ? 'directory' : 'file'}: ${fileName}</span>`;
                    output.appendChild(msgDiv);
                    
                    setTimeout(() => {
                        this.enterFileMode(fileName);
                    }, 500);
                    return true;
                } else if (cmd === 'github') {
                    window.open('https://github.com/MKB-NEL/orabymkb/tree/main/files', '_blank');
                    const msgDiv = document.createElement('div');
                    msgDiv.className = 'output success';
                    msgDiv.textContent = 'Opening GitHub repository in new tab...';
                    output.appendChild(msgDiv);
                    createInputLine();
                    return true;
                } else if (cmd === 'exit') {
                    this.exitORATool();
                    return true;
                } else if (['open', 'print', 'download', 'view'].includes(cmd)) {
                    if (this.mode === 'file-mode') {
                        await this.executeFileCommand(cmd);
                        return true;
                    } else {
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'output error';
                        errorDiv.textContent = `You're currently inside a file. Use "exit" first.`;
                        output.appendChild(errorDiv);
                        createInputLine();
                        return true;
                    }
                }
                
                return false;
            }
        }
        
        // ==============================
        // TERMINAL SYSTEM
        // ==============================
        const terminalOutput = document.getElementById('terminal-output');
        const terminalContainer = document.querySelector('.terminal-container');
        const terminalHeader = document.getElementById('terminal-header');
        const oraTool = new ORATool();
        
        // Command definitions
        const commands = {
            help: {
                description: 'Show all available commands',
                execute: () => {
                    let helpText = '<span class="info">=== ORA TERMINAL COMMANDS ===</span><br><br>';
                    helpText += '<span class="matrix">System Commands:</span><br>';
                    for (const [cmd, info] of Object.entries(commands)) {
                        if (cmd !== 'orastart' && cmd !== 'link') {
                            helpText += `<span class="command">${cmd}</span> - ${info.description}<br>`;
                        }
                    }
                    helpText += '<br><span class="matrix">Link System:</span><br>';
                    helpText += '<span class="command">link show</span> - Access secure Google Drive link<br>';
                    helpText += '<br><span class="matrix">ORA Tool Commands:</span><br>';
                    helpText += '<span class="command">orastart</span> - Launch ORA Tool (GitHub files)<br>';
                    helpText += '<span class="command">ls</span> - List GitHub files<br>';
                    helpText += '<span class="command">cd filename</span> - Open file/directory<br>';
                    helpText += '<span class="command">github</span> - Open GitHub repository<br>';
                    helpText += '<span class="command">open/print/download/view</span> - File operations<br>';
                    helpText += '<span class="command">exit</span> - Exit ORA Tool<br>';
                    helpText += '<br><span class="matrix">GitHub Repository:</span><br>';
                    helpText += '‚Ä¢ https://github.com/MKB-NEL/orabymkb<br>';
                    helpText += '‚Ä¢ Files: /files directory<br>';
                    return helpText;
                }
            },
            clear: {
                description: 'Clear the terminal screen',
                execute: () => {
                    setTimeout(() => {
                        terminalOutput.innerHTML = '';
                        createInputLine();
                    }, 10);
                    return '';
                }
            },
            date: {
                description: 'Show current date and time',
                execute: () => {
                    return new Date().toLocaleString();
                }
            },
            echo: {
                description: 'Echo back the input text',
                execute: (args) => {
                    return args.join(' ');
                }
            },
            about: {
                description: 'Information about this terminal',
                execute: () => {
                    return `<span class="matrix">ORA Terminal Shell v0.1</span><br>
                    Advanced web-based terminal with GitHub integration<br>
                    Features: GitHub file access, Secure link system, ORA Tool<br>
                    Built by Bertrand ‚Ä¢ 2025<br><br>
                    <span class="info">GitHub: MKB-NEL/orabymkb</span><br>
                    <span class="info">Files: /files directory</span>`;
                }
            },
            ls: {
                description: 'List directory contents',
                execute: () => {
                    if (oraTool.mode === 'normal') {
                        return `<span class="info">Type 'orastart' to access GitHub files</span><br>
                        <span class="info">Repository: github.com/MKB-NEL/orabymkb</span>`;
                    }
                    return '';
                }
            },
            pwd: {
                description: 'Print working directory',
                execute: () => {
                    return oraTool.mode === 'normal' ? '/home/user' : oraTool.currentPath;
                }
            },
            color: {
                description: 'Change matrix animation color (1-12)',
                execute: (args) => {
                    if (args.length === 0) {
                        let colors = '<span class="info">Available colors (1-12):</span><br>';
                        matrixColors.forEach((color, index) => {
                            colors += `<span class="command">${index + 1}</span> - <span style="color:${color}">‚ñ†</span> ${color}<br>`;
                        });
                        return colors;
                    }
                    
                    const colorNum = parseInt(args[0]);
                    if (colorNum >= 1 && colorNum <= 12) {
                        matrixColor = matrixColors[colorNum - 1];
                        return `<span class="success">Matrix color changed to #${colorNum}</span>`;
                    } else {
                        return '<span class="error">Color must be between 1 and 12</span>';
                    }
                }
            },
            calc: {
                description: 'Simple calculator',
                execute: (args) => {
                    try {
                        const expression = args.join(' ');
                        const result = eval(expression);
                        return `${expression} = <span class="success">${result}</span>`;
                    } catch {
                        return '<span class="error">Invalid expression</span>';
                    }
                }
            },
            neofetch: {
                description: 'Display system information',
                execute: async () => {
                    const files = await oraTool.fileSystem.scanGitHubFiles();
                    return `
                    <span class="matrix">‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó</span><br>
                    <span class="matrix">‚ïë        ORA TERMINAL INFO             ‚ïë</span><br>
                    <span class="matrix">‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£</span><br>
                    <span class="system">‚ïë OS: ORA Terminal Shell v0.1          ‚ïë</span><br>
                    <span class="system">‚ïë Mode: ${oraTool.mode.toUpperCase()}                      ‚ïë</span><br>
                    <span class="system">‚ïë GitHub Files: ${files.length}                ‚ïë</span><br>
                    <span class="system">‚ïë Repository: MKB-NEL/orabymkb         ‚ïë</span><br>
                    <span class="system">‚ïë Matrix: ${matrixColor}              ‚ïë</span><br>
                    <span class="matrix">‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù</span>`;
                }
            },
            reboot: {
                description: 'Reboot terminal interface',
                execute: () => {
                    setTimeout(() => {
                        location.reload();
                    }, 1000);
                    return '<span class="warning">Rebooting terminal...</span>';
                }
            },
            link: {
                description: 'Access secure link system',
                execute: (args) => {
                    if (args.length === 0) {
                        return `<span class="info">Link System Commands:</span><br>
                        <span class="command">link show</span> - Access secure Google Drive link<br>
                        <span class="info">Password: karekezi@2</span>`;
                    }
                    
                    if (args[0] === 'show') {
                        oraTool.linkSystem.showLinkPrompt();
                        return '';
                    }
                    
                    return '<span class="error">Usage: link show</span>';
                }
            },
            orastart: {
                description: 'Launch ORA Tool with GitHub files',
                execute: async () => {
                    if (oraTool.mode === 'normal') {
                        await oraTool.startBootSequence();
                        return '';
                    } else if (oraTool.mode === 'boot') {
                        return '<span class="info">Boot sequence already running...</span>';
                    } else {
                        return '<span class="error">Already in ORA Tool mode. Type "exit" first.</span>';
                    }
                }
            }
        };
        
        // Command history
        let commandHistory = [];
        let historyIndex = 0;
        
        // ==============================
        // INPUT HANDLING
        // ==============================
        function createInputLine() {
            const inputLine = document.createElement('div');
            inputLine.className = 'input-line';
            
            let promptText = '$';
            if (oraTool.mode === 'ora-tool') {
                promptText = `ORA:${oraTool.currentPath}$`;
            } else if (oraTool.mode === 'file-mode') {
                promptText = `file:${oraTool.currentFile}$`;
            } else if (oraTool.mode === 'login' || oraTool.mode === 'boot') {
                promptText = '>';
            }
            
            inputLine.innerHTML = `
                <span class="prompt">${promptText}</span>
                <input type="text" class="command-input" autocomplete="off">
                <span class="cursor"></span>
            `;
            terminalOutput.appendChild(inputLine);
            
            const input = inputLine.querySelector('.command-input');
            
            setTimeout(() => {
                input.focus();
            }, 10);
            
            input.addEventListener('keydown', async (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const command = input.value.trim();
                    inputLine.remove();
                    await processCommand(command);
                }
                
                // Tab completion
                if (e.key === 'Tab') {
                    e.preventDefault();
                    const currentInput = input.value.trim();
                    const matchingCommands = Object.keys(commands).filter(cmd => 
                        cmd.startsWith(currentInput)
                    );
                    if (matchingCommands.length === 1) {
                        input.value = matchingCommands[0] + ' ';
                    }
                }
                
                // Command history
                if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (commandHistory.length > 0 && historyIndex > 0) {
                        historyIndex--;
                        input.value = commandHistory[historyIndex] || '';
                    }
                }
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (commandHistory.length > 0 && historyIndex < commandHistory.length - 1) {
                        historyIndex++;
                        input.value = commandHistory[historyIndex] || '';
                    } else {
                        historyIndex = commandHistory.length;
                        input.value = '';
                    }
                }
            });
            
            terminalOutput.scrollTop = terminalOutput.scrollHeight;
        }
        
        async function processCommand(fullCommand) {
            // Add to history
            commandHistory.push(fullCommand);
            historyIndex = commandHistory.length;
            
            // Display command
            const commandOutput = document.createElement('div');
            commandOutput.className = 'output';
            
            let promptText = '$';
            if (oraTool.mode === 'ora-tool') {
                promptText = `ORA:${oraTool.currentPath}$`;
            } else if (oraTool.mode === 'file-mode') {
                promptText = `file:${oraTool.currentFile}$`;
            } else if (oraTool.mode === 'login' || oraTool.mode === 'boot') {
                promptText = '>';
            }
            
            commandOutput.innerHTML = `<span class="prompt">${promptText}</span> <span class="command">${fullCommand}</span>`;
            terminalOutput.appendChild(commandOutput);
            
            // Parse command
            const [cmd, ...args] = fullCommand.split(' ');
            
            const resultDiv = document.createElement('div');
            resultDiv.className = 'output';
            
            if (cmd === '') {
                resultDiv.innerHTML = '';
            } else {
                // Check if in ORA Tool mode
                if (oraTool.mode === 'ora-tool' || oraTool.mode === 'file-mode') {
                    const handled = await oraTool.handleORAToolCommand(cmd, args);
                    if (handled) {
                        return;
                    }
                }
                
                // Check if in login mode
                if (oraTool.mode === 'login' || oraTool.mode === 'boot') {
                    resultDiv.innerHTML = '<span class="error">Please complete authentication first</span>';
                } else if (commands[cmd]) {
                    try {
                        const result = commands[cmd].execute(args);
                        if (result instanceof Promise) {
                            resultDiv.innerHTML = await result;
                        } else {
                            resultDiv.innerHTML = result;
                        }
                    } catch (error) {
                        resultDiv.innerHTML = `<span class="error">Error: ${error.message}</span>`;
                    }
                } else {
                    resultDiv.innerHTML = `<span class="error">Command not found: ${cmd}</span><br>
                    Type <span class="command">'help'</span> for available commands`;
                }
            }
            
            terminalOutput.appendChild(resultDiv);
            createInputLine();
        }
        
        // ==============================
        // COPY TO CLIPBOARD FUNCTION
        // ==============================
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Show success message
                const successMsg = document.createElement('div');
                successMsg.className = 'copy-success';
                successMsg.textContent = '‚úì Copied!';
                document.querySelector('.link-box').appendChild(successMsg);
                
                // Remove success message after animation
                setTimeout(() => {
                    if (successMsg.parentNode) {
                        successMsg.parentNode.removeChild(successMsg);
                    }
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                const successMsg = document.createElement('div');
                successMsg.className = 'copy-success';
                successMsg.textContent = '‚úì Copied!';
                document.querySelector('.link-box').appendChild(successMsg);
                
                setTimeout(() => {
                    if (successMsg.parentNode) {
                        successMsg.parentNode.removeChild(successMsg);
                    }
                }, 2000);
            });
        }
        
        // ==============================
        // CONTROL PANEL FUNCTIONS
        // ==============================
        const hidePanelBtn = document.getElementById('hide-panel');
        const resetBtn = document.getElementById('reset-terminal');
        const showLinkBtn = document.getElementById('show-link');
        const controlPanel = document.querySelector('.control-panel');
        
        // Hide/show panel
        hidePanelBtn.addEventListener('click', () => {
            if (controlPanel.style.display !== 'none') {
                controlPanel.style.display = 'none';
                hidePanelBtn.textContent = 'Show Panel';
            } else {
                controlPanel.style.display = 'block';
                hidePanelBtn.textContent = 'Hide Panel';
            }
        });
        
        // Reset terminal position
        resetBtn.addEventListener('click', () => {
            terminalContainer.style.left = '50%';
            terminalContainer.style.top = '50%';
            terminalContainer.style.transform = 'translate(-50%, -50%)';
            terminalContainer.style.width = '800px';
            terminalContainer.style.height = '500px';
            terminalContainer.classList.add('terminal-start-animation');
            
            setTimeout(() => {
                terminalContainer.classList.remove('terminal-start-animation');
            }, 500);
        });
        
        // Show link button
        showLinkBtn.addEventListener('click', () => {
            oraTool.linkSystem.showLinkPrompt();
        });
        
        // Window buttons
        document.getElementById('close-btn').addEventListener('click', () => {
            terminalContainer.style.display = 'none';
            const message = document.createElement('div');
            message.className = 'output error';
            message.textContent = 'Terminal closed. Refresh page to restart.';
            terminalOutput.appendChild(message);
        });
        
        document.getElementById('minimize-btn').addEventListener('click', () => {
            terminalContainer.style.height = '45px';
            setTimeout(() => {
                terminalContainer.style.height = '500px';
            }, 2000);
        });
        
        document.getElementById('maximize-btn').addEventListener('click', () => {
            if (terminalContainer.style.width === '95vw') {
                resetBtn.click();
            } else {
                terminalContainer.style.width = '95vw';
                terminalContainer.style.height = '90vh';
                terminalContainer.style.left = '2.5vw';
                terminalContainer.style.top = '5vh';
                terminalContainer.style.transform = 'none';
            }
        });
        
        // ==============================
        // INITIALIZATION
        // ==============================
        async function init() {
            // Initialize matrix
            initMatrix();
            let matrixInterval = setInterval(drawMatrix, 50);
            
            // Initialize terminal
            createInputLine();
            
            // Handle window resize
            window.addEventListener('resize', () => {
                initMatrix();
                const rect = terminalContainer.getBoundingClientRect();
                if (rect.right > window.innerWidth || rect.bottom > window.innerHeight) {
                    resetBtn.click();
                }
            });
            
            // Global click to focus input
            document.addEventListener('click', (e) => {
                if (!controlPanel.contains(e.target) && !terminalHeader.contains(e.target)) {
                    const input = document.querySelector('.command-input');
                    if (input) input.focus();
                }
            });
            
            // Make copy function globally available
            window.copyToClipboard = copyToClipboard;
        }
        
        // Start everything
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
